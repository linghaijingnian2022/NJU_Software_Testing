# 开发日志

## 开发过程中的进度安排

| 起始时间 | 结束时间 | 具体的进度和安排                                             |
| :------- | :------- | ------------------------------------------------------------ |
| 12月3日  | 12月8日  | 初步参考SOTA模糊测试工具AFL++，了解了AFL++的项目结构和部分使用方法，初步掌握afl-cc和afl-fuzz的使用方法。 |
| 12月10日 | 12月11日 | 查看了本选题指定的全部10个模糊目标的Github仓库，阅读README.md文件，得到相关信息和使用细节。 |
| 12月14日 | 12月16日 | 查看老师与助教给出的2023 软件测试搭建的模糊测试Demo，阅读多个README.md文件，了解了具体架构，对我们要实现的最终形式有了略微具体的概念。 |
| 12月19日 | 12月19日 | 团队成员开了线下会议，最终统一、确认了项目要实现的具体要求和整体框架，分析了从模糊目标、初始种子到达最后的评估图标的整体过程，并做出了团队成员的初步分工。 |
| 12月21日 | 12月21日 | 在github上建立了私有仓库，并且建立了项目的代码框架和相关配置，将队员拉进仓库成为合作者。 |
| 12月22日 | 12月23日 | 初步完成种子排序组件和能量调度组件，建立了Seed类型，计算种子的能量依据覆盖率和执行时间进行加权，种子的排序初步实现4种，依次为按入队顺序进行排序、基于覆盖率排序、基于执行时间排序、使用能量调度组件对种子进行排序（根据能量值）。 |
| 12月24日 | 12月24日 | 初步完成变异组件，参考 afl-fuzz.h#fuzz_one() ， afl fuzz.h#fuzz_one_original()等函数，实现AFL的5个基础变异算子，bitflip、arith、interest、havoc、splice。 |
| 12月26日 | 12月28日 | 实现了测试执行组件和执行结果监控组件，初步实现评估组件的相关内容 |
| 12月30日 | 12月31日 | 对评估组件、测试执行组件进行完善，可以对简单C程序绘制相应的覆盖统计图，验证确保了测试执行组件和评估组件的有效性 |
| 12月31日 | 12月31日 | 使用Dockerfile构建docker，同时在docker中安装需要的依赖库，对我们的目标项目进行编译 |
| 1月2日   | 1月3日   | 在docker中运行程序，得到覆盖等结果，对数据进行整合，通过评估组件得到相应的统计图表——覆盖曲线图，并对结果图表进行简单分析 |
| 1月4日   | 1月4日   | 最后进行整体的项目审查，录制相应的演示视频，上传到B站的账号中，同时填写表格信息，完成项目链接的提交 |



## 任务分配

| 姓名   | 学号      | 分工                                                         |
| ------ | --------- | ------------------------------------------------------------ |
| 朱恩希 | 221250048 | 1、在github上建立私有仓库，拉队员作为合作者<br />2、初步实现种子排序组件<br />3、初步实现能量调度组件<br />4、对评估组件进行完善<br />5、对Dockerfile进行书写<br />6、录制视频 |
| 李俊材 | 221250181 | 1、建立了项目的相关配置<br />2、实现执行结果监控组件<br />3、实现评估组件<br />4、完善评估组件<br />5、对覆盖曲线图进行分析 |
| 黄奕扬 | 221250071 | 1、建立了项目的代码框架<br />2、初步实现变异组件<br />3、初步实现测试执行组件<br />4、对Dockerfile进行书写<br />5、对目标项目进行编译<br />6、书写使用方法和项目结构 |
| 肖一楠 | 221250076 | 1、对Github仓库中十个模糊目标的编译和插装的流程进行总结<br />2、实现了相应的环境配置<br />3、解决了部分插装过程中的问题<br />4、对Dockerfile文件的书写 |



## 问题与解决

### 问题1：**Docker的拉取问题**

**描述：** 在使用Docker时，遇到Docker Hub的网络连接问题，导致无法从Docker Hub成功拉取镜像。多次尝试拉取官方镜像时，发现下载速度极慢，甚至完全无法连接，导致无法继续进行环境的搭建和测试工作。

**解决过程：**

1. 初步尝试了更换镜像源，如使用国内的Docker镜像源，但由于网络不稳定，依然无法成功拉取所需镜像。
2. 经过进一步的调查，发现使用Rainbond镜像站提供的镜像源能够解决这一问题。Rainbond镜像站提供了更稳定、快速的镜像下载服务，尤其适合国内用户。
3. 更改了Docker的镜像源配置，将默认镜像源更改为Rainbond镜像站。
4. 重新执行拉取命令后，镜像能够迅速下载并成功拉取，解决了Docker Hub网络连接不稳定的问题，确保了后续测试环境的顺利搭建。

### 问题2：**Docker环境配置和项目编译问题**

**描述：** 在构建Docker镜像和运行容器时，出现了依赖库未正确安装的问题。尤其是一些模糊测试所需的编译工具和运行时库无法自动加载，导致目标程序无法正确编译。

**解决过程：**

1. 检查Dockerfile中的安装顺序，确保必要的依赖库在正确的顺序下进行安装。
2. 添加了`apt-get update`和`apt-get install`命令，确保所有必要的依赖（如GCC、make、libc-dev等）都能成功安装。
3. 在Dockerfile中加入`RUN ldconfig`确保系统能够正确链接动态库。
4. 对目标程序的编译过程进行更详细的调试，发现了与目标程序编译参数相关的错误。通过修改Dockerfile中的编译步骤，确保能够正确完成目标程序的编译和插装

### 问题3：**目标程序插装过程中遇到的编译错误**

**描述：** 在为目标程序插装时，遇到一些目标程序因缺少依赖库而无法编译的问题，尤其是在使用AFL++工具进行插装时，出现了链接错误。

**解决过程：**

1. 对插装过程中使用的工具链进行了深入分析。
2. 确保所有的头文件和库文件都能正确引用。
3. 通过增加插装步骤的详细日志，捕捉编译过程中的具体错误，逐一修正。

### 问题4：**测试执行组件的代码书写和执行问题**

**描述：** 在开发过程中，测试执行组件的编写和执行流程遇到了一些难题。如何高效地编写代码以执行模糊测试，收集执行结果并监控测试状态，是实现模糊测试工具核心功能的关键问题。我们需要确定测试执行的流程，并逐步实现该功能，确保能够顺利启动测试、执行并收集数据。

**解决过程：**

1. **初步思路与讨论：**

   初步确定了测试执行组件的核心功能：启动模糊测试、监控执行进程、收集结果数据。测试执行的目标是能自动化启动被测试程序，捕获执行过程中的输出，并根据一定的规则统计执行过程中的行为数据，如执行时间、覆盖率、错误等。

   明确了执行流程的关键步骤：测试启动 -> 模拟输入 -> 程序执行 -> 输出监控 -> 数据收集 -> 结果反馈。

2. **逐步确认与完善：**

   初步完成代码后，团队在会议中对测试执行组件的流程进行了逐步确认。通过对小范围样例程序的测试，我们发现了执行流程中的一些潜在问题，比如输入数据格式不一致、执行过程中程序崩溃导致结果无法收集等问题。

   通过多次的调试和改进，我们逐渐完善了代码，确保测试执行流程顺畅，能够正确启动目标程序，收集到必要的测试数据，并反馈测试结果。

3. **最终实现与验证：**

   最终版本的测试执行组件能够自动化运行，模拟多种输入，监控程序状态并收集测试结果。我们验证了多个简单C程序的测试，并成功生成了覆盖率图表，进一步确保了该组件的有效性。

### 问题5：**评估组件中的覆盖曲线图显示不正常**

**描述：** 在评估组件中，绘制的覆盖曲线图显示的覆盖信息不完全，曲线无法正确反映目标程序的覆盖情况，尤其是在测试执行初期。

**解决过程：**

1. 经过排查，发现问题出在覆盖信息的收集过程中。最初的覆盖统计是基于执行的程序输出，但由于程序执行过程中某些信息未能正确传输，导致统计数据不完整。
2. 通过调整评估组件的数据收集方法，确保每次测试执行的覆盖信息都能即时传输。
3. 增强了数据的可视化，修正了绘图函数中的坐标轴问题，确保覆盖曲线能够准确显示。

### 问题6：**评估组件的数据整合延迟**

**描述：** 在将多个测试结果整合后，发现评估组件的数据显示有延迟，尤其是在执行量大时，数据处理的实时性差，导致结果的更新不及时。

**解决过程：**

1. 对数据收集和处理的流程进行了优化，采用异步处理和事件驱动机制，避免了同步处理的阻塞问题。
2. 引入了缓存机制，确保每次测试结果的处理都能立即反馈到图表展示上。
3. 增加了后台数据清理功能，定期清理不必要的中间结果，确保评估组件能够高效处理大规模数据。
